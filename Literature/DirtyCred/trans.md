# DirtyCred：逐步扩大Linux内核权限

## 摘要

内核漏洞DirtyPipe被报道称在Linux5.8以来的几乎所有版本都出现了。使用该漏洞，一个恶意行为可以在不触发已有的内核保护机制的情况下，实现权限的逐步扩大并且利用缓解机制使得该漏洞格外地令人不安。然而，DirtyPipe的成功很大程度上依赖于这个漏洞的能力——它通过Linux pipe注入数据到任意的文件中。这样一种能力在其他的内核漏洞中是很少见的，使得防御相对容易。只要Linux用户去除该漏洞，系统就能变得相对安全。

这项工作提出了一个新的利用方式——DirtyCred，它将其他的Linux内核漏洞推到DirtyPipe的level(TODO)。从技术上说，给定一个Linux内核漏洞，我们的利用方式会交换非特权和特权的credentials(TODO)并因此提供*具有和DirtyPipe类似可利用性*的漏洞。通过这个可利用性，一个恶意行为则能够获得扩大权限的能力，甚至从容器中逃逸。我们通过24个实际内核漏洞，在一个完全防护的Linux系统上评估了这个利用。我们发现DirtyCred能够呈现16个漏洞的可利用性，说明了DirtyCred的重要性。随着可利用性的评估，这项工作进一步提出一个新的内核防范机制。不像已有的Linux内核防范，我们新的防范机制<u>基于他们自己的权限</u> <u>在不重叠的内存区域</u>隔离了内核credential objects(TODO)。我们的实验结果显示出新的防范机制引入了几乎可忽略不计的开销。