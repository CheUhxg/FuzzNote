# 第四章 进程调度

调度程序是**确保进程能有效工作的内核子系统**。
* 调度程序决定哪个进程投入运行、何时运行以及运行的时长。
* 调度程序是Linux系统的基础，才能实现多进程并发。

## 多任务

多任务就是能同时并发多个进程的操作系统。

多任务系统分为两类：非抢占式多任务和抢占式多任务。
* **Linux是抢占式多任务**。

进程若不被抢占，其能够运行的时间是预设好的，称作**时间片**。
* 这样可以避免个别进程独占系统资源以及便于调度程序管理。
* 现在很多操作系统**采用动态时间片计算**的方式。
  * Linux并**没有采取时间片**的方式来达到公平调度。

非抢占式多任务模式中，除非进程主动停止，否则它会一直执行。
* 让步(yielding)：进程主动挂起自己。
* 如果出现不让步的进程就容易导致其他进程永远无法执行。

## Linux的进程调度

Linux采用叫做**O(1)调度器**的调度程序。
* 主要依赖**静态时间片算法**和**针对每一个处理器的运行队列**。
* O(1)调度器在多处理器环境下运行完美，但是调度响应时间敏感的程序却有缺陷。
  * 交互进程：时间敏感的程序。

为提高对交互程序的调度性能，引入了“**反转楼梯最后期限调度算法**”(RSDL)。
* 该算法吸取了**队列理论**，将**公平调度**的概念引入了Linux调度程序。
* 替代O(1)之后，它被称为**完全公平调度算法**(CFS)。

> 本章主要介绍完全公平调度算法，也会介绍O(1)。

## 策略

策略可以决定调度程序何时让什么进程运行。
* 还要负责优化使用处理器时间。

### I/O消耗型和处理器消耗型的进程

进程可以分为I/O消耗型和处理器消耗型。
* I/O消耗型：进程大部分时间用来提交或者等待I/O请求。
  * 常处于可运行状态，大部分时间都在阻塞，运行时间少。
* 处理器消耗型：进程大部分时间都执行代码。
  * 若不被抢占，则一直执行代码，因为I/O阻塞很少。
  * 这种进程一般需要降低调度频率，延长运行时间。
* 划分并不绝对。

调度策略需要平衡**进程响应速度**和**系统利用率**。
* Linux保证了交互系统的性能，优化了进程的响应速度，更倾向于优先调度I/O消耗型进程。


