# 定时器和时间管理

内核中有大量的函数都是**基于时间驱动的**。比如有些函数是**周期执行**的。
* 内核还必须管理系统的运行时间和当前日期。


周期性事件是由**系统定时器**驱动的。
* 系统定时器是一种**可编程硬件芯片**，能以固定频率产生**定时器中断**。
  * *定时器中断处理程序*负责**更新系统时间**和**执行周期性运行的任务**。

**动态定时器**是用来**推迟执行程序的工具**。
* 比如动态关闭程序。
* 内核可以**动态创建和撤销**动态定时器。

## 内核中的时间概念

内核必须在硬件帮助（系统定时器）下才能计算和管理时间。

系统定时器以某种频率**自行触发**（称为击中(hitting)或者射中(popping)），该频率可以通过编程预定，称作节拍率。
* 节拍率对内核是可见的。
* 时钟中断的间隔时间被称作**节拍**：$节拍\times节拍率=1$。

内核就是靠时钟中断间隔来计算*墙上时间*和*系统运行时间*。
* *墙上时间*：实际的时间（绝对时间）。

利用时钟中断周期执行的工作
* 更新系统运行时间和实际时间。
* 在SMP系统上，**均衡**调度程序中各处理器上的运行队列。
* 检查当前进程是否用尽了时间片。
* 运行超时的动态定时器。
* 更新资源消耗和处理器时间的统计值。